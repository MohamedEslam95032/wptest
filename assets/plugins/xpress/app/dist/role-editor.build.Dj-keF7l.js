const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./assets/role-details-view-CHLtJMGj.js","./assets/_plugin-vue_export-helper-y4Xv5kKr.js","./assets/vue-router-mJSwnJkd.js","./assets/styles/vue-router.css","./assets/index-BaxaBONX.js","./assets/index-9hv1rT8S.js","./assets/index-DghDHKPv.js","./assets/styles/index3.css","./assets/preload-helper-Dp1pzeXC.js","./assets/index-C_FNz6s0.js","./assets/styles/role-details-view.css"])))=>i.map(i=>d[i]);
import{_ as de}from"./assets/preload-helper-Dp1pzeXC.js";import{r,o as X,y as Z,u as W,Q as ee,b as x,d as c,e as k,f as a,g as p,h as L,i as $,j as t,n as D,l as h,S as pe,F as te,G as me,c as H,a as Q,t as l,_ as g,D as M,I as _e,J as fe,m as xe,k as he,Y as J,E as U,O as f,q as ve,s as we,v as ge,x as ye,P as be}from"./assets/_plugin-vue_export-helper-y4Xv5kKr.js";import{a as ze,u as ke,D as Se,c as Re,b as Ce}from"./assets/vue-router-mJSwnJkd.js";import{_ as Ve,L as De}from"./assets/index-C_FNz6s0.js";import{_ as Y}from"./assets/index-BaxaBONX.js";import{_ as Le,M as Ne}from"./assets/index-DghDHKPv.js";function se(){const S=r(!1);let u=null;const v=()=>{S.value=document.body.classList.contains("dark")};return X(()=>{v(),u=new MutationObserver(m=>{m.forEach(_=>{_.type==="attributes"&&_.attributeName==="class"&&v()})}),u.observe(document.body,{attributes:!0,attributeFilter:["class"]})}),Z(()=>{u&&u.disconnect()}),{isDark:S}}const Me={class:"translate-x-0"},$e={__name:"index",setup(S){const u=W(),{isDark:v}=se(),m=r(new CSSStyleSheet);return(()=>{const y=document.querySelector("#uixpress-role-editor-css");if(!y){const n=document.createElement("link");n.rel="stylesheet",n.id="uixpress-role-editor-css",n.href=`${u.state.pluginBase}app/dist/assets/styles/role-editor.css`,document.head.appendChild(n),n.onload=()=>{const w=n.sheet;for(const b of[...w.cssRules].reverse())m.value.insertRule(b.cssText)};return}const d=y.sheet;for(const n of[...d.cssRules].reverse())m.value.insertRule(n.cssText)})(),(y,d)=>{const n=ee("RouterView");return c(),x(te,null,[(c(),k($("style"),null,{default:p(()=>[...d[0]||(d[0]=[L(" html{font-size:14px;}#wpcontent{padding:0}",-1)])]),_:1})),a(h(pe),{tag:"div","adopted-style-sheets":[m.value],class:"uipx-normalize"},{default:p(()=>[(c(),k($("style"),null,{default:p(()=>[...d[1]||(d[1]=[L(" :root{font-size:14px}#wpcontent{padding:0}",-1)])]),_:1})),t("div",{class:D(["overflow-hidden uipx-normalize font-sans h-[var(--uixp-body-height)] max-h-[var(--uixp-body-height)]",h(v)?"dark":""])},[a(Ve),t("div",Me,[a(h(De),{height:3})]),a(n)],2)]),_:1},8,["adopted-style-sheets"])],64)}}},Ee={class:"md:w-96 w-full flex flex-col rounded-3xl bg-white dark:bg-zinc-800/30 border border-zinc-200/40 dark:border-zinc-700/30 h-full max-h-full overflow-hidden"},Ie={class:"px-6 pt-6 pb-4"},Te={class:"flex items-center justify-between mb-4"},je={class:"text-xl font-medium text-zinc-900 dark:text-zinc-100"},Pe={class:"relative"},Fe=["placeholder"],Be={class:"flex flex-row place-content-between items-center px-6 pr-4"},Ue={class:"py-2 text-[10px] uppercase tracking-wider font-semibold text-zinc-400 dark:text-zinc-500"},We={class:"flex-1 overflow-auto px-6 pb-6 custom-scrollbar relative"},qe={key:0,class:"p-8 text-center"},Oe={class:"w-12 h-12 bg-zinc-100 dark:bg-zinc-800 rounded-full flex items-center justify-center mx-auto mb-3"},Ae={class:"text-sm text-zinc-500 dark:text-zinc-400"},Ge={key:1,class:"p-8 text-center"},Ke={class:"w-12 h-12 bg-zinc-100 dark:bg-zinc-800 rounded-full flex items-center justify-center mx-auto mb-3"},He={class:"text-sm text-zinc-500 dark:text-zinc-400 mb-2"},Qe={key:2,class:"mt-3 space-y-1"},Je=["onClick"],Ye={class:"flex-1 min-w-0"},Xe={class:"font-medium text-sm mb-1 truncate"},Ze={class:"flex-1 flex flex-col rounded-3xl bg-white dark:bg-zinc-800/30 border border-zinc-200/40 dark:border-zinc-700/30 h-full max-h-full overflow-auto"},et={key:0,class:"flex-1 flex items-center justify-center"},tt={class:"text-center"},st={class:"w-16 h-16 bg-zinc-100 dark:bg-zinc-800 rounded-2xl flex items-center justify-center mx-auto mb-4"},ot={class:"text-lg font-medium text-zinc-900 dark:text-zinc-100 mb-2"},at={class:"text-sm text-zinc-500 dark:text-zinc-400 mb-4"},lt={class:"w-[500px] max-w-[90vw] p-6"},rt={class:"flex items-center justify-between mb-6"},nt={class:"text-xl font-semibold text-zinc-900 dark:text-zinc-100"},it={class:"space-y-4"},ct={class:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2"},ut={class:"text-xs text-zinc-500 dark:text-zinc-400 mt-1"},dt={class:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2"},pt={class:"text-xs text-zinc-500 dark:text-zinc-400 mt-1"},mt={class:"flex items-center gap-3 pt-4 border-t border-zinc-200/50 dark:border-zinc-700/30"},_t={__name:"role-list-view",setup(S){const u=W(),{isDark:v}=se(),m=ze(),_=ke(),y=r(new CSSStyleSheet),d=r(!1),n=r([]),w=r(""),b=r(!1);r(null);const I=r(typeof window<"u"?window.innerWidth:0),oe=r(null),R=r(null),q=r(!1),C=r(""),V=r(""),z=r(!1),T=r(!1),O=H(()=>I.value),N=H(()=>{if(!w.value)return n.value;const e=w.value.toLowerCase();return n.value.filter(s=>s.name.toLowerCase().includes(e)||s.slug.toLowerCase().includes(e))}),j=async()=>{d.value=!0,u.updateState("loading",!0);const s=await U({endpoint:"uixpress/v1/user-roles",params:{}});if(d.value=!1,u.updateState("loading",!1),!(s!=null&&s.data)){f({title:(0,window.wp.i18n.__)("Failed to load roles","uixpress"),type:"error"});return}n.value=await Promise.all(s.data.map(async i=>{const o=await ae(i.value);return{slug:i.value,name:i.label,userCount:o}}))},ae=async e=>{try{const i=await U({endpoint:"wp/v2/users",params:{roles:e,per_page:1}});return(i==null?void 0:i.totalItems)||0}catch{return 0}},le=e=>{if(!e||!e.slug||!G(e.slug)){f({title:(0,window.wp.i18n.__)("Invalid role format","uixpress"),type:"error"});return}m.push({name:"role-details",params:{roleSlug:e.slug}})},re=()=>{C.value="",V.value="",T.value=!1,q.value=!0,R.value&&R.value.show()},P=()=>{q.value=!1,R.value&&R.value.close()},A=e=>e.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");Q(C,e=>{e&&!T.value&&(V.value=A(e))});const ne=()=>{T.value=!0},G=e=>!e||typeof e!="string"?!1:/^[a-z0-9_-]+$/.test(e),ie=e=>{if(!e||typeof e!="string")return!1;const s=e.trim();return s.length>0&&s.length<=100},F=async()=>{const e=C.value.trim(),s=V.value.trim()||A(e);if(!e){f({title:(0,window.wp.i18n.__)("Role name is required","uixpress"),type:"error"});return}if(!ie(e)){f({title:(0,window.wp.i18n.__)("Invalid role name","uixpress"),message:(0,window.wp.i18n.__)("Role name must be between 1 and 100 characters.","uixpress"),type:"error"});return}if(!G(s)){f({title:(0,window.wp.i18n.__)("Invalid role slug","uixpress"),message:(0,window.wp.i18n.__)("Role slug can only contain lowercase letters, numbers, hyphens, and underscores.","uixpress"),type:"error"});return}if(s.length>60){f({title:(0,window.wp.i18n.__)("Role slug too long","uixpress"),message:(0,window.wp.i18n.__)("Role slug must be 60 characters or less.","uixpress"),type:"error"});return}z.value=!0;try{const o=await U({endpoint:"uixpress/v1/role-editor/roles",type:"POST",data:{name:e,slug:s,capabilities:[]}});o!=null&&o.data&&(f({title:(0,window.wp.i18n.__)("Role created successfully","uixpress"),type:"success"}),P(),await j(),m.push({name:"role-details",params:{roleSlug:o.data.slug}}))}catch{f({title:(0,window.wp.i18n.__)("Failed to create role","uixpress"),type:"error"})}finally{z.value=!1}},ce=()=>{let e=document.querySelector("#uixpress-role-editor-css");if(!e)e=ue(),e.onload=()=>{const s=e.sheet;for(const i of[...s.cssRules].reverse())y.value.insertRule(i.cssText)};else{const s=e.sheet;for(const i of[...s.cssRules].reverse())y.value.insertRule(i.cssText)}},ue=()=>{var e=document.createElement("link");return e.rel="stylesheet",e.href=`${u.state.pluginBase}app/dist/assets/styles/role-editor.css`,document.head.appendChild(e),e},K=()=>{I.value=window.innerWidth};return Q(()=>_.params.roleSlug,e=>{e?b.value=!0:b.value=!1},{immediate:!0,deep:!0}),ve("refreshRolesList",j),X(()=>{j(),ce(),I.value=window.innerWidth,window.addEventListener("resize",K)}),Z(()=>{window.removeEventListener("resize",K)}),(e,s)=>{const i=ee("RouterView");return c(),x("div",{class:D(["flex h-full text-zinc-900 dark:text-zinc-100 font-sans max-h-full overflow-hidden gap-6 max-md:gap-0 uipx-normalize",h(v)?"dark":""])},[t("div",Ee,[t("div",Ie,[t("div",Te,[t("h1",je,l(e.__("Role Editor","uixpress")),1),a(M,{onClick:re,type:"primary",class:"text-sm"},{default:p(()=>[a(g,{icon:"add",class:"text-base"}),L(" "+l(e.__("New Role","uixpress")),1)]),_:1})]),t("div",Pe,[a(g,{icon:"search",class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-zinc-400 dark:text-zinc-500 text-base pointer-events-none"}),_e(t("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>w.value=o),type:"text",placeholder:e.__("Search roles...","uixpress"),class:"w-full bg-zinc-50 dark:bg-zinc-900 border-0 rounded-lg pl-10 pr-3 py-2.5 text-sm placeholder-zinc-400 dark:placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-900 dark:focus:ring-zinc-100 transition-shadow"},null,8,Fe),[[fe,w.value]])])]),t("div",Be,[t("div",Ue,l(N.value.length)+" "+l(N.value.length===1?e.__("role","uixpress"):e.__("roles","uixpress")),1)]),t("div",We,[d.value&&!n.value.length?(c(),x("div",qe,[t("div",Oe,[a(g,{icon:"people",class:"text-zinc-400 text-xl animate-pulse"})]),t("p",Ae,l(e.__("Loading roles...","uixpress")),1)])):N.value.length===0?(c(),x("div",Ge,[t("div",Ke,[a(g,{icon:"people",class:"text-zinc-400 text-xl"})]),t("p",He,l(w.value?e.__("No roles found","uixpress"):e.__("No roles available","uixpress")),1)])):(c(),x("div",Qe,[(c(!0),x(te,null,xe(N.value,o=>(c(),x("div",{key:o.slug,onClick:B=>le(o),class:D(["flex items-center justify-between p-3 rounded-xl transition-all duration-200 text-left group -mx-3 cursor-pointer",h(_).params.roleSlug===o.slug?"bg-zinc-100 dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100":"hover:bg-zinc-100 dark:hover:bg-zinc-800 text-zinc-800 dark:text-zinc-200"])},[t("div",Ye,[t("div",Xe,l(o.name),1),t("div",{class:D(["text-xs",(h(_).params.roleSlug===o.slug,"text-zinc-500 dark:text-zinc-400")])},l(o.userCount)+" "+l(o.userCount===1?e.__("user","uixpress"):e.__("users","uixpress")),3)]),a(g,{icon:"chevron_right",class:D(["text-base flex-shrink-0 ml-2 transition-transform duration-200 opacity-0 group-hover:opacity-100",h(_).params.roleSlug===o.slug?"text-zinc-900 dark:text-white opacity-100":"text-zinc-400 dark:text-zinc-500 group-hover:text-zinc-600 dark:group-hover:text-zinc-300 group-hover:translate-x-1"])},null,8,["class"])],10,Je))),128))]))])]),t("div",Ze,[a(i,{key:"role-details-content"},{default:p(({Component:o})=>[o?o&&O.value>1024?(c(),k($(o),{key:1})):o&&O.value<=1024?(c(),k(Se,{key:2,modelValue:b.value,"onUpdate:modelValue":s[1]||(s[1]=B=>b.value=B),size:"full","show-header":!1,"show-close-button":!1,"close-on-overlay-click":!0,"close-on-escape":!0,onClose:s[2]||(s[2]=B=>h(m).push("/"))},{default:p(()=>[(c(),k($(o)))]),_:2},1032,["modelValue"])):he("",!0):(c(),x("div",et,[t("div",tt,[t("div",st,[a(g,{icon:"people",class:"text-2xl text-zinc-400"})]),t("h3",ot,l(e.__("Role Details","uixpress")),1),t("p",at,l(e.__("Select a role from the list to view and edit its capabilities.","uixpress")),1)])]))]),_:1})]),a(Le,{ref_key:"confirmDialog",ref:oe},null,512),a(Ne,{ref_key:"createRoleModal",ref:R},{default:p(()=>[t("div",lt,[t("div",rt,[t("h2",nt,l(e.__("Create New Role","uixpress")),1),a(M,{type:"transparent",onClick:P},{default:p(()=>[a(g,{icon:"close"})]),_:1})]),t("div",it,[t("div",null,[t("label",ct,l(e.__("Role Name","uixpress")),1),a(Y,{modelValue:C.value,"onUpdate:modelValue":s[3]||(s[3]=o=>C.value=o),placeholder:e.__("e.g., Manager","uixpress"),onKeyup:J(F,["enter"]),disabled:z.value},null,8,["modelValue","placeholder","disabled"]),t("p",ut,l(e.__("The display name for this role","uixpress")),1)]),t("div",null,[t("label",dt,l(e.__("Role Slug","uixpress")),1),a(Y,{modelValue:V.value,"onUpdate:modelValue":s[4]||(s[4]=o=>V.value=o),placeholder:e.__("e.g., manager","uixpress"),onKeyup:J(F,["enter"]),onInput:ne,disabled:z.value},null,8,["modelValue","placeholder","disabled"]),t("p",pt,l(e.__("Lowercase letters, numbers, hyphens, and underscores only","uixpress")),1)]),t("div",mt,[a(M,{onClick:P,type:"default",disabled:z.value,class:"flex-1"},{default:p(()=>[L(l(e.__("Cancel","uixpress")),1)]),_:1},8,["disabled"]),a(M,{onClick:F,type:"primary",loading:z.value,class:"flex-1"},{default:p(()=>[L(l(e.__("Create Role","uixpress")),1)]),_:1},8,["loading"])])])])]),_:1},512)],2)}}},ft=me(_t,[["__scopeId","data-v-aa9a7bf3"]]),xt={__name:"layout",setup(S){return(u,v)=>(c(),k(ft))}},E=we($e),ht=ge();E.use(ht);const vt=W();ye(vt,"#uipc-role-editor-script");be(E);const wt=[{path:"/",component:xt,name:"role-editor",meta:{name:(0,window.wp.i18n.__)("Role Editor","uixpress")},children:[{path:"/role/:roleSlug",component:()=>de(()=>import("./assets/role-details-view-CHLtJMGj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url),name:"role-details",meta:{name:(0,window.wp.i18n.__)("Role Details","uixpress")}}]}],gt=Re({history:Ce(),routes:wt});E.use(gt);E.mount("#uix-role-editor-page");export{se as u};
//# sourceMappingURL=role-editor.build.Dj-keF7l.js.map
