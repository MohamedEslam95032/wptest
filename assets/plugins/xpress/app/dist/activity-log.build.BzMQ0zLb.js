const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./assets/activity-details-view-DGlbAe90.js","./assets/vue-router-mJSwnJkd.js","./assets/_plugin-vue_export-helper-y4Xv5kKr.js","./assets/styles/vue-router.css"])))=>i.map(i=>d[i]);
import{_ as ve}from"./assets/preload-helper-Dp1pzeXC.js";import{r as l,o as ee,y as te,u as Y,Q as se,b as u,d as r,e as M,f as p,g as I,h as L,i as G,j as t,n as V,l as j,S as _e,F as O,k as F,m as K,C as xe,_ as D,t as d,G as fe,c as T,a as Q,I as H,J as ge,Y as he,a3 as q,D as X,E as be,s as me,v as ye,x as we,P as ke}from"./assets/_plugin-vue_export-helper-y4Xv5kKr.js";import{a as ae,u as oe,D as ze,c as $e,b as Ae}from"./assets/vue-router-mJSwnJkd.js";import{_ as Ie,L as De}from"./assets/index-C_FNz6s0.js";import{_ as je}from"./assets/checkbox-OW0WsXcV.js";function ne(){const y=l(!1);let v=null;const _=()=>{y.value=document.body.classList.contains("dark")};return ee(()=>{_(),v=new MutationObserver(z=>{z.forEach(w=>{w.type==="attributes"&&w.attributeName==="class"&&_()})}),v.observe(document.body,{attributes:!0,attributeFilter:["class"]})}),te(()=>{v&&v.disconnect()}),{isDark:y}}const Se={class:"translate-x-0"},Pe={__name:"index",setup(y){Y();const{isDark:v}=ne(),_=l(new CSSStyleSheet);return l(!1),l(),(()=>{const x=document.querySelector("#uixpress-activity-log-css").sheet;for(const f of[...x.cssRules].reverse())_.value.insertRule(f.cssText)})(),(w,x)=>{const f=se("RouterView");return r(),u(O,null,[(r(),M(G("style"),null,{default:I(()=>[...x[0]||(x[0]=[L(" html{font-size:14px;}#wpcontent{padding:0}",-1)])]),_:1})),p(j(_e),{tag:"div","adopted-style-sheets":[_.value],class:"uipx-normalize"},{default:I(()=>[(r(),M(G("style"),null,{default:I(()=>[...x[1]||(x[1]=[L(" :root{font-size:14px}#wpcontent{padding:0}",-1)])]),_:1})),t("div",{class:V(["overflow-hidden uipx-normalize font-sans h-[var(--uixp-body-height)] max-h-[var(--uixp-body-height)]",j(v)?"dark":""])},[p(Ie),t("div",Se,[p(j(De),{height:3})]),p(f)],2)]),_:1},8,["adopted-style-sheets"])],64)}}},Ce={class:"relative"},Te={class:"py-2 flex flex-col gap-1"},Ve=["onClick"],Me={class:"flex-shrink-0 relative"},Ne=["onClick"],Fe={class:"w-8 h-8 bg-zinc-200 dark:bg-zinc-700 rounded-full overflow-hidden"},Le=["src","alt"],Re={key:1,class:"w-full h-full flex items-center justify-center"},Ee={class:"flex-1 min-w-0"},We={class:"flex items-center gap-2 flex-wrap"},Ue=["title"],Ge={class:"text-xs text-zinc-500 dark:text-zinc-400"},Oe={key:0},Ze={key:1},Be={class:"text-xs text-zinc-500 dark:text-zinc-400"},He={key:0,class:"flex flex-col items-center justify-center py-12 px-4 text-center"},Ke={class:"text-sm text-zinc-600 dark:text-zinc-400"},Ye={__name:"activity-list",props:{activities:{type:Array,default:()=>[]},selectedActivities:{type:Array,default:()=>[]}},emits:["selectActivity","toggleSelection"],setup(y,{emit:v}){ae();const _=oe(),z=y,w=v,x=l(!1);l({x:0,y:0});const f=l(null),S=(e,n)=>{n.target.closest(".activity-checkbox")||w("selectActivity",e)},$=(e,n)=>{n.stopPropagation(),w("toggleSelection",e,n)},A=e=>z.selectedActivities.includes(e.id),P=e=>{if(!e)return null;if(e.match(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/))return new Date(e+"Z");if(e.includes("T")&&(e.endsWith("Z")||e.match(/[+-]\d{2}:\d{2}$/)))return new Date(e);if(e.includes("T")&&!e.endsWith("Z")&&!e.match(/[+-]\d{2}:\d{2}$/))return new Date(e+"Z");const n=new Date(e);return isNaN(n.getTime())&&e.match(/^\d{4}-\d{2}-\d{2}/)?new Date(e+"Z"):n},R=e=>{if(!e)return"—";const n=P(e);if(!n||isNaN(n.getTime()))return"—";const s=new Date,o=Math.floor((s-n)/1e3);if(o<60)return(0,window.wp.i18n.__)("Just now","uixpress");const m=Math.floor(o/60);if(m<60)return m===1?(0,window.wp.i18n.__)("1 minute ago","uixpress"):(0,window.wp.i18n.__)("%d minutes ago","uixpress").replace("%d",m);const g=Math.floor(m/60);if(g<24)return g===1?(0,window.wp.i18n.__)("1 hour ago","uixpress"):(0,window.wp.i18n.__)("%d hours ago","uixpress").replace("%d",g);const h=Math.floor(g/24);return h<7?h===1?(0,window.wp.i18n.__)("1 day ago","uixpress"):(0,window.wp.i18n.__)("%d days ago","uixpress").replace("%d",h):n.toLocaleDateString(void 0,{month:"short",day:"numeric",year:n.getFullYear()!==s.getFullYear()?"numeric":void 0})},E=e=>({created:"add",updated:"edit",deleted:"delete",trashed:"delete",restored:"restore",activated:"check_circle",deactivated:"cancel",installed:"download",login:"login",logout:"logout",role_changed:"admin_users",status_changed:"flag",uploaded:"upload"})[e]||"info",W=e=>({created:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",updated:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400",deleted:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400",trashed:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400",restored:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",activated:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",deactivated:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400",installed:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400",login:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",logout:"bg-zinc-100 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-400",role_changed:"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400",status_changed:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400",uploaded:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400"})[e]||"bg-zinc-100 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-400",k=e=>{var n,s,o;return(n=e.metadata)!=null&&n.title?e.metadata.title:(s=e.new_value)!=null&&s.title?e.new_value.title:(o=e.old_value)!=null&&o.title?e.old_value.title:e.object_id?`${e.object_type} #${e.object_id}`:e.object_type};return document.addEventListener("click",()=>{x.value=!1,f.value=null}),(e,n)=>(r(),u("div",Ce,[t("div",Te,[(r(!0),u(O,null,K(y.activities,s=>{var o,m,g;return r(),u("div",{key:s.id,onClick:h=>S(s,h),class:V(["flex items-center gap-2.5 px-4 py-2 cursor-pointer transition-colors hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl transition-all group -mx-3 relative",j(_).params.logId==s.id?"bg-zinc-100 dark:bg-zinc-800/60":""])},[t("div",Me,[t("div",{class:V(["absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 transition-opacity duration-200 activity-checkbox cursor-pointer",A(s)?"opacity-100":"opacity-0 group-hover:opacity-100"]),onClick:xe(h=>$(s,h),["stop"])},[p(je,{isactive:A(s)},null,8,["isactive"])],10,Ne),t("div",Fe,[(o=s.user)!=null&&o.avatar?(r(),u("img",{key:0,src:s.user.avatar,alt:s.user.name,class:"w-full h-full object-cover"},null,8,Le)):(r(),u("div",Re,[p(D,{icon:"person",class:"text-zinc-500 dark:text-zinc-400 text-sm"})]))])]),t("div",Ee,[t("div",We,[t("span",{class:V(["font-medium text-sm text-zinc-900 dark:text-zinc-200 truncate",j(_).params.logId==s.id?"text-zinc-900 dark:text-white":"text-zinc-600 dark:text-zinc-400"]),title:(m=s.user)==null?void 0:m.name},d(((g=s.user)==null?void 0:g.name)||e.__("Unknown","uixpress")),11,Ue),t("span",{class:V(["px-2 py-0.5 text-[10px] font-medium rounded uppercase flex items-center gap-1",W(s.action)])},[p(D,{icon:E(s.action),class:"text-[10px]"},null,8,["icon"]),L(" "+d(s.action),1)],2),t("span",Ge,[L(d(s.object_type)+" ",1),s.object_id?(r(),u("span",Oe," #"+d(s.object_id),1)):F("",!0),k(s)&&k(s)!==s.object_type?(r(),u("span",Ze," : "+d(k(s)),1)):F("",!0)]),t("span",Be,d(R(s.created_at)),1)])])],10,Ve)}),128)),y.activities.length===0?(r(),u("div",He,[p(D,{icon:"history",class:"w-12 h-12 text-zinc-400 dark:text-zinc-600 mb-4"}),t("p",Ke,d(e.__("No activities found","uixpress")),1)])):F("",!0)])]))}},Je={class:"md:w-96 w-full flex flex-col rounded-3xl bg-white dark:bg-zinc-800/30 border border-zinc-200/40 dark:border-zinc-700/30 h-full max-h-full overflow-hidden"},Qe={class:"px-6 pt-6 pb-4"},qe={class:"flex items-center justify-between mb-4"},Xe={class:"text-xl font-medium text-zinc-900 dark:text-zinc-100"},et={class:"relative mb-4"},tt=["placeholder"],st={class:"space-y-3"},at={class:"block text-[10px] uppercase tracking-wider font-semibold text-zinc-500 dark:text-zinc-400 mb-1.5"},ot={value:"all"},nt=["value"],it={class:"block text-[10px] uppercase tracking-wider font-semibold text-zinc-500 dark:text-zinc-400 mb-1.5"},lt={value:"all"},rt=["value"],ct={class:"flex flex-row place-content-between items-center px-6 pr-4"},dt={class:"py-2 text-[10px] uppercase tracking-wider font-semibold text-zinc-400 dark:text-zinc-500"},ut={class:"flex flex-row items-center"},pt={class:"text-xs text-zinc-500 dark:text-zinc-500 mr-2"},vt={key:0},_t={class:"flex-1 overflow-auto px-6 pb-6 custom-scrollbar"},xt={class:"flex-1 flex flex-col rounded-3xl bg-white dark:bg-zinc-800/30 border border-zinc-200/40 dark:border-zinc-700/30 h-full max-h-full overflow-auto"},ft={key:0,class:"flex-1 flex items-center justify-center"},gt={class:"text-center"},ht={class:"w-16 h-16 bg-zinc-100 dark:bg-zinc-800 rounded-2xl flex items-center justify-center mx-auto mb-4"},bt={class:"text-lg font-medium text-zinc-900 dark:text-zinc-100 mb-2"},mt={class:"text-sm text-zinc-500 dark:text-zinc-400 mb-4"},yt={__name:"activity-list-view",setup(y){const v=Y(),{isDark:_}=ne(),z=ae(),w=oe(),x=l(!1),f=l([]),S=l([]),$=l(""),A=l("all"),P=l("all"),R=l(null),E=l(null),W=l(null);l("date"),l("desc");const k=l(typeof window<"u"?window.innerWidth:0),e=l(!1),n=l([]),s=l(null),o=l({page:1,per_page:30,total:0,totalPages:0,search:"",order:"desc",orderby:"created_at"}),m=T(()=>k.value),g=T(()=>o.value.page>1),h=T(()=>o.value.totalPages>0&&o.value.page<o.value.totalPages),ie=async()=>{g.value&&(o.value.page-=1,await N())},le=async()=>{h.value&&(o.value.page+=1,await N())},N=async()=>{x.value=!0,v.updateState("loading",!0);const a={page:o.value.page,per_page:o.value.per_page,search:o.value.search||$.value||void 0,order:o.value.order,orderby:o.value.orderby};A.value!=="all"&&(a.action=A.value),P.value!=="all"&&(a.object_type=P.value),R.value&&(a.user_id=R.value),E.value&&(a.date_from=E.value),W.value&&(a.date_to=W.value);const b=await be({endpoint:"uixpress/v1/activity-log",params:a});x.value=!1,v.updateState("loading",!1),b&&(f.value=b.data||[],o.value.total=parseInt(b.totalItems||0),o.value.totalPages=parseInt(b.totalPages||0))},re=a=>{z.push({name:"activity-log-details",params:{logId:a.id}})},ce=(a,c)=>{const b=S.value.findIndex(i=>i.id===a.id);if(c!=null&&c.shiftKey&&s.value!==null){const i=Math.min(s.value,b),C=Math.max(s.value,b);S.value.slice(i,C+1).map(U=>U.id).forEach(U=>{n.value.includes(U)||n.value.push(U)}),s.value=b}else{const i=n.value.findIndex(C=>C===a.id);i>-1?n.value.splice(i,1):n.value.push(a.id),s.value=b}};T(()=>n.value.length>0);const de=async()=>{o.value.page=1,o.value.search=$.value,await N()},J=async()=>{o.value.page=1,await N()};Q(()=>w.params.logId,a=>{k.value<1024&&(e.value=!!a)},{immediate:!0});const B=()=>{k.value=window.innerWidth,k.value>=1024&&(e.value=!1)};ee(()=>{window.addEventListener("resize",B),B(),N()}),te(()=>{window.removeEventListener("resize",B)});const ue=T(()=>{const a=new Set;return f.value.forEach(c=>{c.action&&a.add(c.action)}),Array.from(a).sort()}),pe=T(()=>{const a=new Set;return f.value.forEach(c=>{c.object_type&&a.add(c.object_type)}),Array.from(a).sort()});return Q([f,$],()=>{S.value=f.value}),(a,c)=>{const b=se("RouterView");return r(),u("div",{class:V(["flex h-full text-zinc-900 dark:text-zinc-100 font-sans max-h-full overflow-hidden gap-6 max-md:gap-0 uipx-normalize",j(_)?"dark":""])},[t("div",Je,[t("div",Qe,[t("div",qe,[t("h1",Xe,d(a.__("Activity Log","uixpress")),1)]),t("div",et,[p(D,{icon:"search",class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-zinc-400 dark:text-zinc-500 text-base pointer-events-none"}),H(t("input",{"onUpdate:modelValue":c[0]||(c[0]=i=>$.value=i),onKeyup:he(de,["enter"]),type:"text",placeholder:a.__("Search activities...","uixpress"),class:"w-full bg-zinc-50 dark:bg-zinc-900 border-0 rounded-lg pl-10 pr-3 py-2.5 text-sm placeholder-zinc-400 dark:placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-900 dark:focus:ring-zinc-100 transition-shadow"},null,40,tt),[[ge,$.value]])]),t("div",st,[t("div",null,[t("label",at,d(a.__("Action","uixpress")),1),H(t("select",{"onUpdate:modelValue":c[1]||(c[1]=i=>A.value=i),onChange:J,class:"w-full px-3 py-2 bg-zinc-50 dark:bg-zinc-900 border-0 rounded-lg text-sm text-zinc-900 dark:text-zinc-100 focus:outline-none focus:ring-2 focus:ring-zinc-900 dark:focus:ring-zinc-100"},[t("option",ot,d(a.__("All Actions","uixpress")),1),(r(!0),u(O,null,K(ue.value,i=>(r(),u("option",{key:i,value:i},d(i),9,nt))),128))],544),[[q,A.value]])]),t("div",null,[t("label",it,d(a.__("Object Type","uixpress")),1),H(t("select",{"onUpdate:modelValue":c[2]||(c[2]=i=>P.value=i),onChange:J,class:"w-full px-3 py-2 bg-zinc-50 dark:bg-zinc-900 border-0 rounded-lg text-sm text-zinc-900 dark:text-zinc-100 focus:outline-none focus:ring-2 focus:ring-zinc-900 dark:focus:ring-zinc-100"},[t("option",lt,d(a.__("All Types","uixpress")),1),(r(!0),u(O,null,K(pe.value,i=>(r(),u("option",{key:i,value:i},d(i),9,rt))),128))],544),[[q,P.value]])])])]),t("div",ct,[t("div",dt,d(o.value.total)+" "+d(o.value.total===1?a.__("item","uixpress"):a.__("items","uixpress")),1),t("div",ut,[t("div",pt,[L(d(a.__("Page","uixpress"))+" "+d(o.value.page)+" ",1),o.value.totalPages>0?(r(),u("span",vt," / "+d(o.value.totalPages),1)):F("",!0)]),p(X,{type:"transparent",disabled:!g.value,onClick:ie,"aria-disabled":!g.value,title:a.__("Previous","uixpress")},{default:I(()=>[p(D,{icon:"chevron_left"})]),_:1},8,["disabled","aria-disabled","title"]),p(X,{type:"transparent",disabled:!h.value,onClick:le,"aria-disabled":!h.value,title:a.__("Next","uixpress")},{default:I(()=>[p(D,{icon:"chevron_right"})]),_:1},8,["disabled","aria-disabled","title"])])]),t("div",_t,[p(Ye,{activities:S.value,"selected-activities":n.value,onSelectActivity:re,onToggleSelection:ce},null,8,["activities","selected-activities"])])]),t("div",xt,[p(b,{key:"activity-log-details-content"},{default:I(({Component:i})=>[i?i&&m.value>1024?(r(),M(G(i),{key:1})):i&&m.value<=1024?(r(),M(ze,{key:2,modelValue:e.value,"onUpdate:modelValue":c[3]||(c[3]=C=>e.value=C),size:"full","show-header":!1,"show-close-button":!1,"close-on-overlay-click":!0,"close-on-escape":!0,onClose:c[4]||(c[4]=C=>j(z).push("/"))},{default:I(()=>[(r(),M(G(i)))]),_:2},1032,["modelValue"])):F("",!0):(r(),u("div",ft,[t("div",gt,[t("div",ht,[p(D,{icon:"history",class:"text-2xl text-zinc-400"})]),t("h3",bt,d(a.__("Activity Details","uixpress")),1),t("p",mt,d(a.__("Select an activity from the list to view detailed information.","uixpress")),1)])]))]),_:1})])],2)}}},wt=fe(yt,[["__scopeId","data-v-09f96867"]]),kt={__name:"layout",setup(y){return(v,_)=>(r(),M(wt))}},Z=me(Pe),zt=ye();Z.use(zt);const $t=Y();we($t,"#uipc-activity-log-script");ke(Z);const At=[{path:"/",component:kt,name:"activity-log-library",meta:{name:(0,window.wp.i18n.__)("Activity Log","uixpress")},children:[{path:"details/:logId",component:()=>ve(()=>import("./assets/activity-details-view-DGlbAe90.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),name:"activity-log-details",meta:{name:(0,window.wp.i18n.__)("Activity Log Details","uixpress")}}]}],It=$e({history:Ae(),routes:At});Z.use(It);Z.mount("#uix-activity-log-page");
//# sourceMappingURL=activity-log.build.BzMQ0zLb.js.map
