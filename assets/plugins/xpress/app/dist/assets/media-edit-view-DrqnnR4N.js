import{u as Ct,a as Rt}from"./vue-router-mJSwnJkd.js";import{G as It,r as p,c as De,a as Me,o as Je,y as Wt,b as Z,d as N,j as t,f as W,_ as G,t as d,k as ve,n as Ae,K as Ht,g as Q,h as ce,D as J,I as T,J as q,F as Vt,m as jt,$ as At,p as Ce,u as $t,e as Et,E as Ke,O as Xe}from"./_plugin-vue_export-helper-y4Xv5kKr.js";const St=(e,s)=>{if(s<=0)return e;const r=e.data,m=e.width,i=e.height,o=new ImageData(new Uint8ClampedArray(r),m,i),c=o.data,z=[0,-1,0,-1,5,-1,0,-1,0],y=s/100;for(let u=1;u<i-1;u++)for(let h=1;h<m-1;h++){let f=0,v=0,M=0;for(let C=-1;C<=1;C++)for(let b=-1;b<=1;b++){const R=((u+C)*m+(h+b))*4,k=z[(C+1)*3+(b+1)];f+=r[R]*k,v+=r[R+1]*k,M+=r[R+2]*k}const g=(u*m+h)*4;c[g]=Math.max(0,Math.min(255,r[g]+(f-r[g])*y)),c[g+1]=Math.max(0,Math.min(255,r[g+1]+(v-r[g+1])*y)),c[g+2]=Math.max(0,Math.min(255,r[g+2]+(M-r[g+2])*y)),c[g+3]=r[g+3]}return o},Lt=(e,s)=>{if(s<=0)return e;const r=e.data,m=e.width,i=e.height,o=new ImageData(new Uint8ClampedArray(r),m,i),c=o.data,y=s/100*30;for(let u=0;u<r.length;u+=4){const h=(Math.random()*2-1)*y;c[u]=Math.max(0,Math.min(255,r[u]+h)),c[u+1]=Math.max(0,Math.min(255,r[u+1]+h)),c[u+2]=Math.max(0,Math.min(255,r[u+2]+h)),c[u+3]=r[u+3]}return o},Qe=(e,s)=>{if(s<=0)return e;const r=e.data,m=e.width,i=e.height,o=new ImageData(new Uint8ClampedArray(r),m,i),c=o.data,z=Math.ceil(s);for(let u=0;u<i;u++)for(let h=0;h<m;h++){let f=0,v=0,M=0,g=0;for(let b=-z;b<=z;b++){const R=Math.max(0,Math.min(m-1,h+b)),k=(u*m+R)*4;f+=r[k],v+=r[k+1],M+=r[k+2],g++}const C=(u*m+h)*4;c[C]=f/g,c[C+1]=v/g,c[C+2]=M/g}const y=new Uint8ClampedArray(c);for(let u=0;u<i;u++)for(let h=0;h<m;h++){let f=0,v=0,M=0,g=0;for(let b=-z;b<=z;b++){const k=(Math.max(0,Math.min(i-1,u+b))*m+h)*4;f+=y[k],v+=y[k+1],M+=y[k+2],g++}const C=(u*m+h)*4;c[C]=f/g,c[C+1]=v/g,c[C+2]=M/g}return o},Ut=(e,s,r,m)=>{if(m===0)return{r:e,g:s,b:r};const i=Math.max(e,s,r),o=Math.min(e,s,r),c=i===0?0:(i-o)/i,y=e>95&&s>40&&r>20&&e>s&&e>r?m*.3:m;if(c>0){const u=.299*e+.587*s+.114*r,h=1+y/100;e=u+h*(e-u),s=u+h*(s-u),r=u+h*(r-u)}return{r:e,g:s,b:r}},Ze=(e,s)=>{const{brightness:r,contrast:m,saturation:i,hue:o,exposure:c,vibrance:z,sharpness:y,highlights:u,shadows:h,temperature:f,tint:v,blur:M,grain:g,vignette:C}=s;if(r===0&&m===0&&i===0&&o===0&&c===0&&z===0&&y===0&&u===0&&h===0&&f===0&&v===0&&M===0&&g===0)return;const b=e.getContext("2d");let R=b.getImageData(0,0,e.width,e.height);if(M>0){R=Qe(R,M/10);const w=document.createElement("canvas");w.width=e.width,w.height=e.height;const _=w.getContext("2d");_.putImageData(R,0,0),R=_.getImageData(0,0,e.width,e.height)}if(y<0){R=Qe(R,Math.abs(y)/10);const w=document.createElement("canvas");w.width=e.width,w.height=e.height;const _=w.getContext("2d");_.putImageData(R,0,0),R=_.getImageData(0,0,e.width,e.height)}const k=R.data,le=r/100,ee=c/100,oe=m/100,F=1+i/100,te=z,K=o*Math.PI/180,ae=u/100,ne=h/100,U=f/100,B=v/100;for(let w=0;w<k.length;w+=4){let _=k[w],I=k[w+1],V=k[w+2];const se=.299*_+.587*I+.114*V;if(ae!==0&&se>128){const x=(se-128)/127*ae;_+=x*255,I+=x*255,V+=x*255}if(ne!==0&&se<128){const x=(1-se/127)*ne;_-=x*255,I-=x*255,V-=x*255}const re=le+ee;re!==0&&(_+=re*255,I+=re*255,V+=re*255);const me=oe+ee*.5;if(me!==0){const x=259*(me*255+255)/(255*(259-me*255));_=x*(_-128)+128,I=x*(I-128)+128,V=x*(V-128)+128}if(U!==0&&(U>0?(_+=U*20,I+=U*10):(V+=Math.abs(U)*20,I+=Math.abs(U)*5)),B!==0&&(B>0?(_+=B*15,V+=B*15):I+=Math.abs(B)*20),F!==1){const x=.299*_+.587*I+.114*V;_=x+F*(_-x),I=x+F*(I-x),V=x+F*(V-x)}if(te!==0){const x=Ut(_,I,V,te);_=x.r,I=x.g,V=x.b}if(K!==0){const x=Math.cos(K),ie=Math.sin(K),$=_*(x+(1-x)/3)+I*((1-x)/3-Math.sqrt(3)*ie/3)+V*((1-x)/3+Math.sqrt(3)*ie/3),E=_*((1-x)/3+Math.sqrt(3)*ie/3)+I*(x+(1-x)/3)+V*((1-x)/3-Math.sqrt(3)*ie/3),j=_*((1-x)/3-Math.sqrt(3)*ie/3)+I*((1-x)/3+Math.sqrt(3)*ie/3)+V*(x+(1-x)/3);_=$,I=E,V=j}k[w]=Math.max(0,Math.min(255,_)),k[w+1]=Math.max(0,Math.min(255,I)),k[w+2]=Math.max(0,Math.min(255,V))}if(b.putImageData(R,0,0),y>0){const w=St(R,y);b.putImageData(w,0,0)}if(g>0){const w=Lt(R,g);b.putImageData(w,0,0)}if(C>0){const w=e.width/2,_=e.height/2,I=Math.sqrt(w*w+_*_),V=C/100,se=b.createRadialGradient(w,_,0,w,_,I);se.addColorStop(0,"rgba(0, 0, 0, 0)"),se.addColorStop(1,`rgba(0, 0, 0, ${V*.8})`),b.fillStyle=se,b.fillRect(0,0,e.width,e.height)}},Dt=(e,s,r)=>{e.rotation.value=(e.rotation.value+s)%360,r()},Xt=(e,s)=>{e.flipHorizontal.value=!e.flipHorizontal.value,s()},Yt=(e,s)=>{e.flipVertical.value=!e.flipVertical.value,s()},Bt=(e,s)=>{e.rotation.value=0,e.flipHorizontal.value=!1,e.flipVertical.value=!1,s()},Tt=(e,s,r,m,i)=>{const o={brightness:e.brightness.value,contrast:e.contrast.value,saturation:e.saturation.value,hue:e.hue.value,exposure:e.exposure.value,vibrance:e.vibrance.value,sharpness:e.sharpness.value,highlights:e.highlights.value,shadows:e.shadows.value,temperature:e.temperature.value,tint:e.tint.value,vignette:e.vignette.value,blur:e.blur.value,grain:e.grain.value,rotation:e.rotation.value,flipHorizontal:e.flipHorizontal.value,flipVertical:e.flipVertical.value,imageWidth:e.imageWidth.value,imageHeight:e.imageHeight.value,imageData:i?i.src:null};r.value<s.value.length-1&&(s.value=s.value.slice(0,r.value+1)),s.value.push(o),r.value=s.value.length-1,s.value.length>m&&(s.value.shift(),r.value--)},et=async(e,s,r,m,i)=>{var o;if(e.brightness.value=s.brightness,e.contrast.value=s.contrast,e.saturation.value=s.saturation,e.hue.value=s.hue,e.exposure.value=s.exposure,e.vibrance.value=s.vibrance,e.sharpness.value=s.sharpness,e.highlights.value=s.highlights||0,e.shadows.value=s.shadows||0,e.temperature.value=s.temperature||0,e.tint.value=s.tint||0,e.vignette.value=s.vignette||0,e.blur.value=s.blur||0,e.grain.value=s.grain||0,e.rotation.value=s.rotation,e.flipHorizontal.value=s.flipHorizontal,e.flipVertical.value=s.flipVertical,e.imageWidth.value=s.imageWidth,e.imageHeight.value=s.imageHeight,s.imageData&&s.imageData!==((o=i.value)==null?void 0:o.src)){const c=new Image;c.crossOrigin="anonymous",await new Promise((z,y)=>{c.onload=()=>{i.value=c,z()},c.onerror=y,c.src=s.imageData})}await r(),m()},Ft=async(e,s,r,m,i,o)=>{if(s.value<=0)return;s.value--;const c=e.value[s.value];await et(r,c,m,i,o)},Ot=async(e,s,r,m,i,o)=>{if(s.value>=e.value.length-1)return;s.value++;const c=e.value[s.value];await et(r,c,m,i,o)},Pt=e=>{e.lockAspectRatio.value&&e.originalAspectRatio.value>0&&(e.resizeHeight.value=Math.round(e.resizeWidth.value/e.originalAspectRatio.value))},qt=e=>{e.lockAspectRatio.value&&e.originalAspectRatio.value>0&&(e.resizeWidth.value=Math.round(e.resizeHeight.value*e.originalAspectRatio.value))},Gt=async(e,s,r,m)=>{if(!e.currentImage.value||e.resizeWidth.value<=0||e.resizeHeight.value<=0)return;const i=document.createElement("canvas");i.width=e.resizeWidth.value,i.height=e.resizeHeight.value;const o=i.getContext("2d");o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.drawImage(e.currentImage.value,0,0,e.resizeWidth.value,e.resizeHeight.value);const c=new Image;c.crossOrigin="anonymous",await new Promise((z,y)=>{c.onload=()=>{e.currentImage.value=c,e.imageWidth.value=c.width,e.imageHeight.value=c.height,e.originalAspectRatio.value=c.width/c.height,z()},c.onerror=y,c.src=i.toDataURL("image/png")}),await s(),r(),m()},Nt=async(e,s,r,m,i)=>{s.loading.value=!0,s.imageLoaded.value=!1;const o=new Image;o.crossOrigin="anonymous",await new Promise((c,z)=>{o.onload=()=>{s.originalImage.value=o,s.currentImage.value=o,s.imageWidth.value=o.width,s.imageHeight.value=o.height,s.resizeWidth.value=o.width,s.resizeHeight.value=o.height,s.originalAspectRatio.value=o.width/o.height,s.imageLoaded.value=!0,s.loading.value=!1,c()},o.onerror=()=>{s.loading.value=!1,z(new Error("Failed to load image"))},o.src=e}),await r(),m(),i()},Kt=(e,s,r,m)=>{if(!e||!r.currentImage.value)return;const i=e,o=s;if(!o)return;const c=o.clientWidth,z=o.clientHeight,y=r.imageWidth.value/r.imageHeight.value,u=c/z;let h,f;y>u?(h=Math.min(c-40,r.imageWidth.value),f=h/y):(f=Math.min(z-40,r.imageHeight.value),h=f*y),i.width=h,i.height=f,r.scale.value=h/r.imageWidth.value,m()},Qt=(e,s)=>{if(!s||!e.currentImage.value)return null;const r=e.resizeWidth.value>0&&e.resizeWidth.value!==e.imageWidth.value?e.resizeWidth.value:e.imageWidth.value,m=e.resizeHeight.value>0&&e.resizeHeight.value!==e.imageHeight.value?e.resizeHeight.value:e.imageHeight.value,i=document.createElement("canvas");i.width=r,i.height=m;const o=i.getContext("2d");o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.save(),o.translate(i.width/2,i.height/2),o.rotate(e.rotation.value*Math.PI/180),e.flipHorizontal.value&&o.scale(-1,1),e.flipVertical.value&&o.scale(1,-1),o.drawImage(e.currentImage.value,-i.width/2,-i.height/2,i.width,i.height),o.restore();const c={brightness:e.brightness.value,contrast:e.contrast.value,saturation:e.saturation.value,hue:e.hue.value,exposure:e.exposure.value,vibrance:e.vibrance.value,sharpness:e.sharpness.value,highlights:e.highlights.value,shadows:e.shadows.value,temperature:e.temperature.value,tint:e.tint.value,vignette:e.vignette.value,blur:e.blur.value,grain:e.grain.value};return Ze(i,c),i.toDataURL("image/jpeg",.92)},Jt=(e,s,r)=>{if(!s||r<=0)return;const m=s.width/2,i=s.height/2,o=Math.sqrt(m*m+i*i),c=r/100,z=e.createRadialGradient(m,i,0,m,i,o);z.addColorStop(0,"rgba(0, 0, 0, 0)"),z.addColorStop(1,`rgba(0, 0, 0, ${c*.8})`),e.fillStyle=z,e.fillRect(0,0,s.width,s.height)},Zt=(e,s,r,m,i,o)=>{if(!s)return;const c=Math.min(r,i),z=Math.min(m,o),y=Math.max(r,i),u=Math.max(m,o),h=y-c,f=u-z;if(h<=0||f<=0)return;e.fillStyle="rgba(0, 0, 0, 0.6)",e.fillRect(0,0,s.width,s.height),e.globalCompositeOperation="destination-out",e.fillRect(c,z,h,f),e.globalCompositeOperation="source-over",e.strokeStyle="#3b82f6",e.lineWidth=2,e.setLineDash([]),e.strokeRect(c,z,h,f);const v=12;e.fillStyle="#3b82f6",e.strokeStyle="#ffffff",e.lineWidth=2,e.fillRect(c-v/2,z-v/2,v,v),e.strokeRect(c-v/2,z-v/2,v,v),e.fillRect(y-v/2,z-v/2,v,v),e.strokeRect(y-v/2,z-v/2,v,v),e.fillRect(c-v/2,u-v/2,v,v),e.strokeRect(c-v/2,u-v/2,v,v),e.fillRect(y-v/2,u-v/2,v,v),e.strokeRect(y-v/2,u-v/2,v,v)},ea={class:"flex-1 flex flex-col h-full bg-white dark:bg-zinc-950"},ta={key:0,class:"flex-1 flex items-center justify-center"},aa={class:"text-center"},na={class:"w-12 h-12 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center mx-auto mb-3"},sa={class:"text-sm text-zinc-500 dark:text-zinc-400"},ia={key:1,class:"flex-1 flex flex-col lg:flex-row h-full overflow-hidden"},la={class:"w-full lg:w-80 bg-white dark:bg-zinc-900 border-t lg:border-t-0 lg:border-l border-zinc-200 dark:border-zinc-800 flex flex-col min-h-0 lg:max-h-full overflow-hidden"},oa={class:"px-4 py-3 border-b border-zinc-200 dark:border-zinc-800 flex items-center justify-between"},ra={class:"text-sm font-semibold text-zinc-900 dark:text-zinc-200"},ca={class:"flex items-center gap-2"},ua={class:"flex-1 overflow-y-auto"},da={class:"border-b border-zinc-200 dark:border-zinc-800"},va={class:"text-sm font-medium text-zinc-900 dark:text-zinc-200"},pa={key:0,class:"px-4 pb-4 space-y-4"},ma={class:"flex items-center justify-between mb-1.5"},ha={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},ga={class:"text-xs text-zinc-500 font-mono"},xa={class:"flex items-center justify-between mb-1.5"},fa={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},ba={class:"text-xs text-zinc-500 font-mono"},_a={class:"flex items-center justify-between mb-1.5"},za={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},wa={class:"text-xs text-zinc-500 font-mono"},ya={class:"flex items-center justify-between mb-1.5"},ka={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},Ma={class:"text-xs text-zinc-500 font-mono"},Ca={class:"flex items-center justify-between mb-1.5"},Ra={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},Ia={class:"text-xs text-zinc-500 font-mono"},Wa={class:"border-b border-zinc-200 dark:border-zinc-800"},Ha={class:"text-sm font-medium text-zinc-900 dark:text-zinc-200"},Va={key:0,class:"px-4 pb-4 space-y-4"},ja={class:"flex items-center justify-between mb-1.5"},Aa={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},$a={class:"text-xs text-zinc-500 font-mono"},Ea={class:"flex items-center justify-between mb-1.5"},Sa={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},La={class:"text-xs text-zinc-500 font-mono"},Ua={class:"flex items-center justify-between mb-1.5"},Da={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},Xa={class:"text-xs text-zinc-500 font-mono"},Ya={class:"flex items-center justify-between mb-1.5"},Ba={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},Ta={class:"text-xs text-zinc-500 font-mono"},Fa={class:"text-[10px] text-zinc-500 dark:text-zinc-400 mt-0.5"},Oa={class:"flex items-center justify-between mb-1.5"},Pa={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},qa={class:"text-xs text-zinc-500 font-mono"},Ga={class:"text-[10px] text-zinc-500 dark:text-zinc-400 mt-0.5"},Na={class:"border-b border-zinc-200 dark:border-zinc-800"},Ka={class:"text-sm font-medium text-zinc-900 dark:text-zinc-200"},Qa={key:0,class:"px-4 pb-4 space-y-4"},Ja={class:"flex items-center justify-between mb-1.5"},Za={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},en={class:"text-xs text-zinc-500 font-mono"},tn={class:"text-[10px] text-zinc-500 dark:text-zinc-400 mt-0.5"},an={class:"flex items-center justify-between mb-1.5"},nn={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},sn={class:"text-xs text-zinc-500 font-mono"},ln={class:"flex items-center justify-between mb-1.5"},on={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},rn={class:"text-xs text-zinc-500 font-mono"},cn={class:"flex items-center justify-between mb-1.5"},un={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},dn={class:"text-xs text-zinc-500 font-mono"},vn={class:"border-b border-zinc-200 dark:border-zinc-800"},pn={class:"text-sm font-medium text-zinc-900 dark:text-zinc-200"},mn={key:0,class:"px-4 pb-4 space-y-3"},hn={class:"text-xs text-zinc-500 dark:text-zinc-400 mb-2"},gn={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400 mb-2 block"},xn={class:"grid grid-cols-3 gap-1.5"},fn=["onClick"],bn={class:"border-b border-zinc-200 dark:border-zinc-800"},_n={class:"text-sm font-medium text-zinc-900 dark:text-zinc-200"},zn={key:0,class:"px-4 pb-4 space-y-3"},wn={class:"flex items-center gap-2"},yn={for:"lockAspectRatio",class:"text-xs text-zinc-500 dark:text-zinc-400"},kn={class:"flex items-center justify-between mb-1.5"},Mn={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},Cn={class:"text-xs text-zinc-500 font-mono"},Rn={class:"flex items-center justify-between mb-1.5"},In={class:"text-xs font-medium text-zinc-500 dark:text-zinc-400"},Wn={class:"text-xs text-zinc-500 font-mono"},Hn={class:"border-b border-zinc-200 dark:border-zinc-800"},Vn={class:"text-sm font-medium text-zinc-900 dark:text-zinc-200"},jn={key:0,class:"px-4 pb-4 space-y-3"},An={class:"grid grid-cols-2 gap-2"},$n={class:"px-4 py-3 border-t border-zinc-200 dark:border-zinc-800 flex items-center justify-end gap-2 bg-white dark:bg-zinc-900"},En=50,Sn={__name:"index",props:{src:{type:String,required:!0},disabled:{type:Boolean,default:!1}},emits:["save","cancel"],setup(e,{emit:s}){const r=e,m=s,i=p(null);p(null);const o=p(null),c=p(!1),z=p(!0),y=p(null),u=p(null),h=p(0),f=p(0),v=p(1);p(0),p(0);const M=p(0),g=p(!1),C=p(!1),b=p(0),R=p(0),k=p(0),le=p(0),ee=p(0),oe=p(0),F=p(0),te=p(0),K=p(0),ae=p(0),ne=p(0),U=p(0),B=p(0),w=p(0),_=p(0),I=p(0),V=p(!0),se=p(1),re=p(!1),me=p([]),x=p(-1),ie=p(!1),$=p(0),E=p(0),j=p(0),S=p(0),he=p(!1),Re=p(!1),Ye=p(0),Be=p(0),tt=p(0),at=p(0),Ie=p({centerX:0,centerY:0}),fe=p(!1),be=p(null),nt=[{label:(0,window.wp.i18n.__)("Free","uixpress"),value:null},{label:"1:1",value:1},{label:"4:3",value:4/3},{label:"3:4",value:3/4},{label:"16:9",value:16/9},{label:"9:16",value:9/16},{label:"21:9",value:21/9},{label:"5:4",value:5/4},{label:"4:5",value:4/5}];p(!0);const O=p({luminosity:!0,color:!1,effects:!1,transform:!1,resize:!1,crop:!1}),ue=De(()=>{const a=Math.min($.value,j.value),n=Math.min(E.value,S.value),l=Math.max($.value,j.value),H=Math.max(E.value,S.value);return l-a>5&&H-n>5}),We=()=>{if(!ue.value||!i.value||!o.value){Ie.value={centerX:0,centerY:0};return}const a=i.value,n=o.value,l=a.getBoundingClientRect(),H=n.getBoundingClientRect(),L=l.left-H.left+n.scrollLeft,D=l.top-H.top+n.scrollTop,Y=Math.min($.value,j.value),A=Math.min(E.value,S.value),X=Math.max($.value,j.value),de=Math.max(E.value,S.value);Ie.value={centerX:L+Y+(X-Y)/2,centerY:D+A+(de-A)/2}},st=(a,n)=>{if(!ue.value)return!1;const l=Math.min($.value,j.value),H=Math.min(E.value,S.value),L=Math.max($.value,j.value),D=Math.max(E.value,S.value);return a>=l&&a<=L&&n>=H&&n<=D},it=De(()=>ie.value?he.value?!0:Re.value?!1:ue.value:!1),He=()=>{Tt({brightness:b,contrast:R,saturation:k,hue:le,exposure:ee,vibrance:oe,sharpness:F,highlights:te,shadows:K,temperature:ae,tint:ne,vignette:U,blur:B,grain:w,rotation:M,flipHorizontal:g,flipVertical:C,imageWidth:h,imageHeight:f},me,x,En,u.value)},lt=async()=>{await Ft(me,x,{brightness:b,contrast:R,saturation:k,hue:le,exposure:ee,vibrance:oe,sharpness:F,highlights:te,shadows:K,temperature:ae,tint:ne,vignette:U,blur:B,grain:w,rotation:M,flipHorizontal:g,flipVertical:C,imageWidth:h,imageHeight:f},Ce,_e,u)},ot=async()=>{await Ot(me,x,{brightness:b,contrast:R,saturation:k,hue:le,exposure:ee,vibrance:oe,sharpness:F,highlights:te,shadows:K,temperature:ae,tint:ne,vignette:U,blur:B,grain:w,rotation:M,flipHorizontal:g,flipVertical:C,imageWidth:h,imageHeight:f},Ce,_e,u)},rt=De(()=>x.value>0),ct=De(()=>x.value<me.value.length-1),ut=async()=>{try{const a={loading:z,imageLoaded:c,originalImage:y,currentImage:u,imageWidth:h,imageHeight:f,resizeWidth:_,resizeHeight:I,originalAspectRatio:se};await Nt(r.src,a,Ce,_e,He)}catch(a){console.error("Failed to load image:",a),z.value=!1}},_e=()=>{const a={currentImage:u,imageWidth:h,imageHeight:f,scale:v};Kt(i.value,o.value,a,P)},P=()=>{if(!i.value||!u.value)return;const a=re.value?y.value:u.value,n=i.value,l=n.getContext("2d");l.clearRect(0,0,n.width,n.height),l.save(),l.translate(n.width/2,n.height/2);const H=a.width/a.height,L=n.width/n.height;let D,Y;if(H>L?(D=n.width,Y=n.width/H):(Y=n.height,D=n.height*H),!re.value){l.rotate(M.value*Math.PI/180);let A=1,X=1;g.value&&(A=-1),C.value&&(X=-1),l.scale(A,X)}if(l.drawImage(a,-D/2,-Y/2,D,Y),l.restore(),!ie.value&&!re.value){const A=document.createElement("canvas");A.width=n.width,A.height=n.height,A.getContext("2d").drawImage(n,0,0);const de={brightness:b.value,contrast:R.value,saturation:k.value,hue:le.value,exposure:ee.value,vibrance:oe.value,sharpness:F.value,highlights:te.value,shadows:K.value,temperature:ae.value,tint:ne.value,vignette:U.value,blur:B.value,grain:w.value};Ze(A,de),l.clearRect(0,0,n.width,n.height),l.drawImage(A,0,0)}!re.value&&U.value>0&&Jt(l,n,U.value),ie.value&&(he.value||ue.value)?Zt(l,n,$.value,E.value,j.value,S.value):(Ie.value={centerX:0,centerY:0},fe.value=!1)},dt=a=>{if(!i.value)return;fe.value=!1;const n=i.value,l=n.getBoundingClientRect(),H=a.clientX-l.left,L=a.clientY-l.top;if(ue.value&&st(H,L)){Re.value=!0,Ye.value=H,Be.value=L;const D=Math.min($.value,j.value),Y=Math.min(E.value,S.value),A=Math.max($.value,j.value),X=Math.max(E.value,S.value);tt.value=H-(D+A)/2,at.value=L-(Y+X)/2,n.addEventListener("mousemove",Oe),n.addEventListener("mouseup",$e),n.addEventListener("mouseleave",$e);return}$.value=H,E.value=L,j.value=H,S.value=L,he.value=!0,ie.value=!0,P(),n.addEventListener("mousemove",Fe),n.addEventListener("mouseup",Ee),n.addEventListener("mouseleave",Ee)},vt=a=>{if(be.value=a,ue.value){const n=Math.min($.value,j.value),l=Math.min(E.value,S.value),H=Math.max($.value,j.value),L=Math.max(E.value,S.value),D=H-n,Y=L-l;if(a!==null)if(D/Y>a){const X=D/a;S.value=l+X}else{const X=Y*a;j.value=n+X}P()}},Fe=a=>{if(!he.value||!i.value)return;const l=i.value.getBoundingClientRect();let H=a.clientX-l.left,L=a.clientY-l.top;if(be.value!==null){const D=$.value,Y=E.value,A=H-D,X=L-Y;Math.abs(A/X)>be.value?L=Y+Math.abs(A)/be.value*(X<0?-1:1):H=D+Math.abs(X)*be.value*(A<0?-1:1)}j.value=H,S.value=L,P()},Oe=a=>{if(!Re.value||!i.value)return;const n=i.value,l=n.getBoundingClientRect(),H=a.clientX-l.left,L=a.clientY-l.top,D=H-Ye.value,Y=L-Be.value,A=Math.min($.value,j.value),X=Math.min(E.value,S.value),de=Math.max($.value,j.value),we=Math.max(E.value,S.value),ge=de-A,xe=we-X,ye=Math.max(0,Math.min(n.width-ge,A+D)),ke=Math.max(0,Math.min(n.height-xe,X+Y)),Ve=ye+ge,je=ke+xe;$.value<j.value?($.value=ye,j.value=Ve):($.value=Ve,j.value=ye),E.value<S.value?(E.value=ke,S.value=je):(E.value=je,S.value=ke),Ye.value=H,Be.value=L,P(),Ce(()=>{We()})},$e=()=>{Re.value=!1,i.value&&(i.value.removeEventListener("mousemove",Oe),i.value.removeEventListener("mouseup",$e),i.value.removeEventListener("mouseleave",$e)),P(),ue.value&&(fe.value=!0,We())},Ee=()=>{i.value&&(i.value.removeEventListener("mousemove",Fe),i.value.removeEventListener("mouseup",Ee),i.value.removeEventListener("mouseleave",Ee)),he.value=!1,P(),ue.value&&(fe.value=!0,We())};Me(()=>O.value.crop,a=>{});const pt=()=>{if(!i.value||!u.value)return;const a=i.value,n=Math.min($.value,j.value),l=Math.min(E.value,S.value),H=Math.max($.value,j.value),L=Math.max(E.value,S.value),D=H-n,Y=L-l;if(D<=0||Y<=0){Te();return}const A=u.value.width/u.value.height,X=a.width/a.height;let de,we,ge,xe;A>X?(de=a.width,we=a.width/A,ge=0,xe=(a.height-we)/2):(we=a.height,de=a.height*A,ge=(a.width-de)/2,xe=0);const ye=u.value.width/de,ke=u.value.height/we,Ve=Math.max(0,(n-ge)*ye),je=Math.max(0,(l-xe)*ke),kt=Math.min(u.value.width,(H-ge)*ye),Mt=Math.min(u.value.height,(L-xe)*ke),Se=kt-Ve,Le=Mt-je;if(Se<=0||Le<=0){Te();return}const Ue=document.createElement("canvas");Ue.width=Se,Ue.height=Le,Ue.getContext("2d").drawImage(u.value,Ve,je,Se,Le,0,0,Se,Le);const pe=new Image;pe.onload=async()=>{u.value=pe,h.value=pe.width,f.value=pe.height,_.value=pe.width,I.value=pe.height,se.value=pe.width/pe.height,ie.value=!1,he.value=!1,M.value=0,g.value=!1,C.value=!1,await Ce(),_e(),He()},pe.src=Ue.toDataURL("image/png")},Te=()=>{ie.value=!1,he.value=!1,$.value=0,E.value=0,j.value=0,S.value=0,fe.value=!1,P()},Pe=a=>{Dt({rotation:M},a,P)},mt=()=>{Xt({flipHorizontal:g},P)},ht=()=>{Yt({flipVertical:C},P)},gt=()=>{b.value=0,R.value=0,k.value=0,le.value=0,ee.value=0,oe.value=0,F.value=0,te.value=0,K.value=0,ae.value=0,ne.value=0,U.value=0,B.value=0,w.value=0,P()},xt=()=>{Bt({rotation:M,flipHorizontal:g,flipVertical:C},P),He()},ze=a=>{O.value[a]=!O.value[a]},ft=()=>{Pt({resizeWidth:_,resizeHeight:I,lockAspectRatio:V,originalAspectRatio:se})},bt=()=>{qt({resizeWidth:_,resizeHeight:I,lockAspectRatio:V,originalAspectRatio:se})},_t=async()=>{await Gt({currentImage:u,resizeWidth:_,resizeHeight:I,imageWidth:h,imageHeight:f,originalAspectRatio:se},Ce,_e,He)},zt=()=>{const a={canvasRef:i.value,currentImage:u,resizeWidth:_,resizeHeight:I,imageWidth:h,imageHeight:f,rotation:M,flipHorizontal:g,flipVertical:C,brightness:b,contrast:R,saturation:k,hue:le,exposure:ee,vibrance:oe,sharpness:F,highlights:te,shadows:K,temperature:ae,tint:ne,vignette:U,blur:B,grain:w};return Qt(a,i.value)},wt=()=>{const a=zt();a&&m("save",a)},yt=()=>{m("cancel")};Me([b,R,k,le,ee,oe,F,te,K,ae,ne,U,B,w],()=>{c.value&&P()}),Me([M,g,C],()=>{c.value&&P()}),Me(re,()=>{c.value&&P()});let qe=null;Me([b,R,k,le,ee,oe,F,te,K,ae,ne,U,B,w,M,g,C],()=>{c.value&&x.value>=0&&(clearTimeout(qe),qe=setTimeout(()=>{He()},500))}),Me([$,E,j,S],()=>{ue.value&&We()});const Ge=()=>{c.value&&_e()},Ne=()=>{ue.value&&We()};return Je(async()=>{await ut(),window.addEventListener("resize",Ge),o.value&&o.value.addEventListener("scroll",Ne)}),Wt(()=>{window.removeEventListener("resize",Ge),o.value&&o.value.removeEventListener("scroll",Ne)}),(a,n)=>(N(),Z("div",ea,[z.value?(N(),Z("div",ta,[t("div",aa,[t("div",na,[W(G,{icon:"image",class:"text-xl text-zinc-400 dark:text-zinc-500 animate-pulse"})]),t("p",sa,d(a.__("Loading image...","uixpress")),1)])])):(N(),Z("div",ia,[t("div",{ref_key:"containerRef",ref:o,class:"flex-1 flex items-center justify-center overflow-auto bg-white dark:bg-zinc-950 relative min-h-0"},[t("canvas",{ref_key:"canvasRef",ref:i,onMousedown:dt,class:Ae(["max-w-full max-h-full",{"cursor-crosshair":it.value,"cursor-move":Re.value}])},null,34),ue.value&&fe.value?(N(),Z("div",{key:0,class:"absolute flex items-center gap-2 z-10 pointer-events-auto",style:Ht({left:`${Ie.value.centerX}px`,top:`${Ie.value.centerY}px`,transform:"translate(-50%, -50%)"})},[W(J,{onClick:pt,class:"text-xs py-2 px-4 shadow-lg"},{default:Q(()=>[ce(d(a.__("Apply","uixpress")),1)]),_:1}),W(J,{onClick:Te,type:"transparent",class:"text-xs py-2 px-4 shadow-lg bg-white/95 dark:bg-zinc-900/95 backdrop-blur-sm"},{default:Q(()=>[ce(d(a.__("Cancel","uixpress")),1)]),_:1})],4)):ve("",!0)],512),t("div",la,[t("div",oa,[t("h2",ra,d(a.__("Image Editor","uixpress")),1),t("div",ca,[W(J,{onClick:n[0]||(n[0]=l=>re.value=!re.value),type:"transparent",class:Ae(["text-xs py-1.5 px-2",re.value?"bg-indigo-500/20 text-indigo-400":"text-zinc-500 dark:text-zinc-400"])},{default:Q(()=>[W(G,{icon:"compare",class:"text-sm"})]),_:1},8,["class"]),W(J,{onClick:lt,type:"transparent",class:"text-xs py-1.5 px-2",disabled:!rt.value},{default:Q(()=>[W(G,{icon:"undo",class:"text-sm"})]),_:1},8,["disabled"]),W(J,{onClick:ot,type:"transparent",class:"text-xs py-1.5 px-2",disabled:!ct.value},{default:Q(()=>[W(G,{icon:"redo",class:"text-sm"})]),_:1},8,["disabled"])])]),t("div",ua,[t("div",da,[t("button",{onClick:n[1]||(n[1]=l=>ze("luminosity")),class:"w-full px-4 py-3 flex items-center justify-between hover:bg-zinc-100 dark:hover:bg-zinc-800/50 transition-colors"},[t("span",va,d(a.__("Luminosity","uixpress")),1),W(G,{icon:O.value.luminosity?"expand_less":"expand_more",class:"text-zinc-500 dark:text-zinc-400 text-base"},null,8,["icon"])]),O.value.luminosity?(N(),Z("div",pa,[t("div",null,[t("div",ma,[t("label",ha,d(a.__("Brightness","uixpress")),1),t("span",ga,d(b.value),1)]),T(t("input",{"onUpdate:modelValue":n[2]||(n[2]=l=>b.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,b.value,void 0,{number:!0}]])]),t("div",null,[t("div",xa,[t("label",fa,d(a.__("Exposure","uixpress")),1),t("span",ba,d(ee.value),1)]),T(t("input",{"onUpdate:modelValue":n[3]||(n[3]=l=>ee.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,ee.value,void 0,{number:!0}]])]),t("div",null,[t("div",_a,[t("label",za,d(a.__("Highlights","uixpress")),1),t("span",wa,d(te.value),1)]),T(t("input",{"onUpdate:modelValue":n[4]||(n[4]=l=>te.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,te.value,void 0,{number:!0}]])]),t("div",null,[t("div",ya,[t("label",ka,d(a.__("Shadows","uixpress")),1),t("span",Ma,d(K.value),1)]),T(t("input",{"onUpdate:modelValue":n[5]||(n[5]=l=>K.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,K.value,void 0,{number:!0}]])]),t("div",null,[t("div",Ca,[t("label",Ra,d(a.__("Contrast","uixpress")),1),t("span",Ia,d(R.value),1)]),T(t("input",{"onUpdate:modelValue":n[6]||(n[6]=l=>R.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,R.value,void 0,{number:!0}]])])])):ve("",!0)]),t("div",Wa,[t("button",{onClick:n[7]||(n[7]=l=>ze("color")),class:"w-full px-4 py-3 flex items-center justify-between hover:bg-zinc-100 dark:hover:bg-zinc-800/50 transition-colors"},[t("span",Ha,d(a.__("Color","uixpress")),1),W(G,{icon:O.value.color?"expand_less":"expand_more",class:"text-zinc-500 dark:text-zinc-400 text-base"},null,8,["icon"])]),O.value.color?(N(),Z("div",Va,[t("div",null,[t("div",ja,[t("label",Aa,d(a.__("Saturation","uixpress")),1),t("span",$a,d(k.value),1)]),T(t("input",{"onUpdate:modelValue":n[8]||(n[8]=l=>k.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,k.value,void 0,{number:!0}]])]),t("div",null,[t("div",Ea,[t("label",Sa,d(a.__("Vibrance","uixpress")),1),t("span",La,d(oe.value),1)]),T(t("input",{"onUpdate:modelValue":n[9]||(n[9]=l=>oe.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,oe.value,void 0,{number:!0}]])]),t("div",null,[t("div",Ua,[t("label",Da,d(a.__("Hue","uixpress")),1),t("span",Xa,d(le.value)+"°",1)]),T(t("input",{"onUpdate:modelValue":n[10]||(n[10]=l=>le.value=l),type:"range",min:"-180",max:"180",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,le.value,void 0,{number:!0}]])]),t("div",null,[t("div",Ya,[t("label",Ba,d(a.__("Temperature","uixpress")),1),t("span",Ta,d(ae.value),1)]),T(t("input",{"onUpdate:modelValue":n[11]||(n[11]=l=>ae.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,ae.value,void 0,{number:!0}]]),t("p",Fa,d(a.__("Cool ← → Warm","uixpress")),1)]),t("div",null,[t("div",Oa,[t("label",Pa,d(a.__("Tint","uixpress")),1),t("span",qa,d(ne.value),1)]),T(t("input",{"onUpdate:modelValue":n[12]||(n[12]=l=>ne.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,ne.value,void 0,{number:!0}]]),t("p",Ga,d(a.__("Green ← → Magenta","uixpress")),1)])])):ve("",!0)]),t("div",Na,[t("button",{onClick:n[13]||(n[13]=l=>ze("effects")),class:"w-full px-4 py-3 flex items-center justify-between hover:bg-zinc-100 dark:hover:bg-zinc-800/50 transition-colors"},[t("span",Ka,d(a.__("Effects","uixpress")),1),W(G,{icon:O.value.effects?"expand_less":"expand_more",class:"text-zinc-500 dark:text-zinc-400 text-base"},null,8,["icon"])]),O.value.effects?(N(),Z("div",Qa,[t("div",null,[t("div",Ja,[t("label",Za,d(a.__("Sharpness","uixpress")),1),t("span",en,d(F.value),1)]),T(t("input",{"onUpdate:modelValue":n[14]||(n[14]=l=>F.value=l),type:"range",min:"-100",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,F.value,void 0,{number:!0}]]),t("p",tn,d(a.__("Negative = blur, positive = sharpen","uixpress")),1)]),t("div",null,[t("div",an,[t("label",nn,d(a.__("Blur","uixpress")),1),t("span",sn,d(B.value),1)]),T(t("input",{"onUpdate:modelValue":n[15]||(n[15]=l=>B.value=l),type:"range",min:"0",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,B.value,void 0,{number:!0}]])]),t("div",null,[t("div",ln,[t("label",on,d(a.__("Grain","uixpress")),1),t("span",rn,d(w.value),1)]),T(t("input",{"onUpdate:modelValue":n[16]||(n[16]=l=>w.value=l),type:"range",min:"0",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,w.value,void 0,{number:!0}]])]),t("div",null,[t("div",cn,[t("label",un,d(a.__("Vignette","uixpress")),1),t("span",dn,d(U.value),1)]),T(t("input",{"onUpdate:modelValue":n[17]||(n[17]=l=>U.value=l),type:"range",min:"0",max:"100",step:"1",class:"w-full h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-indigo-500"},null,512),[[q,U.value,void 0,{number:!0}]])])])):ve("",!0)]),t("div",vn,[t("button",{onClick:n[18]||(n[18]=l=>ze("crop")),class:"w-full px-4 py-3 flex items-center justify-between hover:bg-zinc-100 dark:hover:bg-zinc-800/50 transition-colors"},[t("span",pn,d(a.__("Crop","uixpress")),1),W(G,{icon:O.value.crop?"expand_less":"expand_more",class:"text-zinc-500 dark:text-zinc-400 text-base"},null,8,["icon"])]),O.value.crop?(N(),Z("div",mn,[t("p",hn,d(a.__("Click and drag on the image to select crop area","uixpress")),1),t("div",null,[t("label",gn,d(a.__("Aspect Ratio","uixpress")),1),t("div",xn,[(N(),Z(Vt,null,jt(nt,l=>t("button",{key:l.value,onClick:H=>vt(l.value),class:Ae(["px-2 py-1.5 text-xs rounded-md transition-colors",be.value===l.value?"bg-indigo-500 text-white":"bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-300 hover:bg-zinc-200 dark:hover:bg-zinc-700"])},d(l.label),11,fn)),64))])]),W(J,{onClick:n[19]||(n[19]=l=>{ie.value=!0,O.value.crop=!0}),type:"transparent",class:"w-full text-xs py-1.5"},{default:Q(()=>[ce(d(a.__("Start Crop","uixpress")),1)]),_:1})])):ve("",!0)]),t("div",bn,[t("button",{onClick:n[20]||(n[20]=l=>ze("resize")),class:"w-full px-4 py-3 flex items-center justify-between hover:bg-zinc-100 dark:hover:bg-zinc-800/50 transition-colors"},[t("span",_n,d(a.__("Resize","uixpress")),1),W(G,{icon:O.value.resize?"expand_less":"expand_more",class:"text-zinc-500 dark:text-zinc-400 text-base"},null,8,["icon"])]),O.value.resize?(N(),Z("div",zn,[t("div",wn,[T(t("input",{"onUpdate:modelValue":n[21]||(n[21]=l=>V.value=l),type:"checkbox",id:"lockAspectRatio",class:"w-4 h-4 rounded border-zinc-300 dark:border-zinc-700 bg-zinc-100 dark:bg-zinc-800 text-indigo-500 focus:ring-indigo-500"},null,512),[[At,V.value]]),t("label",yn,d(a.__("Lock aspect ratio","uixpress")),1)]),t("div",null,[t("div",kn,[t("label",Mn,d(a.__("Width","uixpress")),1),t("span",Cn,d(_.value)+"px",1)]),T(t("input",{"onUpdate:modelValue":n[22]||(n[22]=l=>_.value=l),onInput:ft,type:"number",min:"1",class:"w-full px-2 py-1.5 text-xs bg-zinc-100 dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 rounded text-zinc-900 dark:text-zinc-200 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,544),[[q,_.value,void 0,{number:!0}]])]),t("div",null,[t("div",Rn,[t("label",In,d(a.__("Height","uixpress")),1),t("span",Wn,d(I.value)+"px",1)]),T(t("input",{"onUpdate:modelValue":n[23]||(n[23]=l=>I.value=l),onInput:bt,type:"number",min:"1",class:"w-full px-2 py-1.5 text-xs bg-zinc-100 dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 rounded text-zinc-900 dark:text-zinc-200 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,544),[[q,I.value,void 0,{number:!0}]])]),W(J,{onClick:_t,class:"w-full text-xs py-1.5",disabled:_.value<=0||I.value<=0},{default:Q(()=>[ce(d(a.__("Apply Resize","uixpress")),1)]),_:1},8,["disabled"])])):ve("",!0)]),t("div",Hn,[t("button",{onClick:n[24]||(n[24]=l=>ze("transform")),class:"w-full px-4 py-3 flex items-center justify-between hover:bg-zinc-100 dark:hover:bg-zinc-800/50 transition-colors"},[t("span",Vn,d(a.__("Transform","uixpress")),1),W(G,{icon:O.value.transform?"expand_less":"expand_more",class:"text-zinc-500 dark:text-zinc-400 text-base"},null,8,["icon"])]),O.value.transform?(N(),Z("div",jn,[t("div",An,[W(J,{onClick:n[25]||(n[25]=l=>Pe(-90)),type:"transparent",class:"flex items-center justify-center gap-1.5 text-xs py-2"},{default:Q(()=>[W(G,{icon:"rotate_left",class:"text-sm"}),ce(" "+d(a.__("Left","uixpress")),1)]),_:1}),W(J,{onClick:n[26]||(n[26]=l=>Pe(90)),type:"transparent",class:"flex items-center justify-center gap-1.5 text-xs py-2"},{default:Q(()=>[W(G,{icon:"rotate_right",class:"text-sm"}),ce(" "+d(a.__("Right","uixpress")),1)]),_:1}),W(J,{onClick:mt,type:"transparent",class:Ae(["flex items-center justify-center gap-1.5 text-xs py-2",g.value?"bg-indigo-500/20 text-indigo-400":""])},{default:Q(()=>[W(G,{icon:"flip",class:"text-sm"}),ce(" "+d(a.__("Flip H","uixpress")),1)]),_:1},8,["class"]),W(J,{onClick:ht,type:"transparent",class:Ae(["flex items-center justify-center gap-1.5 text-xs py-2",C.value?"bg-indigo-500/20 text-indigo-400":""])},{default:Q(()=>[W(G,{icon:"flip_camera_android",class:"text-sm"}),ce(" "+d(a.__("Flip V","uixpress")),1)]),_:1},8,["class"])]),W(J,{onClick:xt,type:"transparent",class:"w-full text-xs py-1.5"},{default:Q(()=>[ce(d(a.__("Reset","uixpress")),1)]),_:1})])):ve("",!0)])]),t("div",$n,[W(J,{onClick:gt,type:"transparent",class:"text-xs py-1.5 mr-auto"},{default:Q(()=>[ce(d(a.__("Reset changes","uixpress")),1)]),_:1}),W(J,{onClick:yt,type:"transparent",class:"text-xs py-2 px-3"},{default:Q(()=>[ce(d(a.__("Cancel","uixpress")),1)]),_:1}),W(J,{onClick:wt,class:"text-xs py-2 px-3"},{default:Q(()=>[ce(d(a.__("Save","uixpress")),1)]),_:1})])])]))]))}},Ln=It(Sn,[["__scopeId","data-v-e5b3f87d"]]),Un={class:"flex-1 flex h-full max-h-full overflow-hidden bg-white dark:bg-zinc-950"},Dn={key:0,class:"flex-1 flex items-center justify-center"},Xn={class:"text-center"},Yn={class:"w-12 h-12 rounded-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center mx-auto mb-3"},Bn={class:"text-sm text-zinc-500 dark:text-zinc-400"},Tn={key:1,class:"flex-1 flex flex-col h-full"},Fn={class:"flex items-center justify-between px-6 py-2 border-b border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900"},On={class:"flex items-center gap-4"},Pn={class:"text-sm"},qn={class:"flex items-center gap-3"},Gn={class:"text-sm text-zinc-500 dark:text-zinc-400"},Nn={class:"flex items-center gap-3"},Kn={class:"text-sm text-zinc-500 dark:text-zinc-400"},Qn={key:0},Jn={class:"flex-1 overflow-hidden"},as={__name:"media-edit-view",setup(e){const s=$t(),r=Ct(),m=Rt(),i=p(!1),o=p(null),c=p(!1),z=async()=>{if(!r.params.mediaId)return;i.value=!0,s.updateState("loading",!0);const f={endpoint:`wp/v2/media/${r.params.mediaId}`,params:{context:"edit"}},v=await Ke(f);if(i.value=!1,s.updateState("loading",!1),!(v!=null&&v.data)){Xe({title:(0,window.wp.i18n.__)("Media item not found","uixpress"),type:"error"}),m.push({name:"media-library"});return}if(o.value=v.data,!o.value.mime_type.startsWith("image/")){Xe({title:(0,window.wp.i18n.__)("Only images can be edited","uixpress"),type:"error"}),m.push({name:"media-details",params:{mediaId:r.params.mediaId}});return}},y=async f=>{var v;if(f){c.value=!0;try{const g=await(await fetch(f)).blob(),C=new File([g],((v=o.value.media_details)==null?void 0:v.file)||"edited-image.jpg",{type:"image/jpeg"}),b=new FormData;b.append("file",C),b.append("action","replace_media_file"),b.append("media_id",o.value.id);const k=await Ke({endpoint:"uixpress/v1/media/replace",type:"POST",data:b,isFormData:!0});k!=null&&k.data&&(Xe({title:(0,window.wp.i18n.__)("Image saved successfully","uixpress"),type:"success"}),m.push({name:"media-details",params:{mediaId:r.params.mediaId}}))}catch(M){console.error("Save error:",M),Xe({title:(0,window.wp.i18n.__)("Failed to save image","uixpress"),type:"error"})}finally{c.value=!1}}},u=()=>{m.push({name:"media-details",params:{mediaId:r.params.mediaId}})},h=f=>{if(!f)return"—";const v=["B","KB","MB","GB"],M=Math.floor(Math.log(f)/Math.log(1024));return Math.round(f/Math.pow(1024,M)*10)/10+" "+v[M]};return Je(async()=>{await z()}),(f,v)=>{var M,g,C,b;return N(),Z("div",Un,[i.value?(N(),Z("div",Dn,[t("div",Xn,[t("div",Yn,[W(G,{icon:"image",class:"text-xl text-zinc-400 animate-pulse"})]),t("p",Bn,d(f.__("Loading...","uixpress")),1)])])):o.value?(N(),Z("div",Tn,[t("div",Fn,[t("div",On,[t("button",{onClick:u,class:"flex items-center gap-2 px-3 py-2 rounded-lg text-zinc-500 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors"},[W(G,{icon:"arrow_back",class:"text-base"}),t("span",Pn,d(f.__("Back","uixpress")),1)]),t("div",qn,[t("div",null,[t("p",Gn,d(((M=o.value.media_details)==null?void 0:M.file)||"image.jpg"),1)])])]),t("div",Nn,[t("div",Kn,[(g=o.value.media_details)!=null&&g.width&&((C=o.value.media_details)!=null&&C.height)?(N(),Z("span",Qn,d(o.value.media_details.width)+" × "+d(o.value.media_details.height),1)):ve("",!0),v[0]||(v[0]=t("span",{class:"mx-2"},"•",-1)),t("span",null,d(h((b=o.value.media_details)==null?void 0:b.filesize)),1)])])]),t("div",Jn,[o.value.source_url?(N(),Et(Ln,{key:0,src:o.value.source_url,onSave:y,onCancel:u},null,8,["src"])):ve("",!0)])])):ve("",!0)])}}};export{as as default};
//# sourceMappingURL=media-edit-view-DrqnnR4N.js.map
