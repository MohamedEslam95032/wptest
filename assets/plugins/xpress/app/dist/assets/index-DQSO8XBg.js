import{H as N,z as K,A as O,r as u,w as T,b as o,d as a,k as d,f as n,B as Y,l as j,e as H,t as f,g,_ as p,C as J,D as x,j as i,I as L,Y as X,J as q,F as m,m as z,E as A}from"./_plugin-vue_export-helper-y4Xv5kKr.js";import{_ as G}from"./index-C-cYCD9B.js";import{_ as V}from"./index-9hv1rT8S.js";import{_ as Q}from"./index-B-3JnImM.js";const W={key:0,class:"grow"},Z={key:1,class:"text-zinc-500 grow"},ee={class:"flex flex-col gap-3 w-[260px]"},se={class:"relative flex"},le=["placeholder"],te={class:"absolute top-0 left-0 h-full flex flex-col place-content-center px-2 py-1"},ae={key:0,class:"flex flex-col max-h-80 overflow-auto"},oe=["onClick"],ne={key:1,class:"flex flex-col max-h-80 overflow-auto"},re=["onClick"],ue={key:2,class:"flex flex-row place-content-end items-center gap-1"},ve={__name:"index",props:N(["options","placeholder"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup($){const I=K(),l=O($,"modelValue"),_=u(""),h=u(null),k=u(null),r=u({per_page:10,page:1,pages:0,total:0}),w=u([]),y=u([]),B={users:{value:"users",label:(0,window.wp.i18n.__)("Users","uixpress")},roles:{value:"roles",label:(0,window.wp.i18n.__)("Roles","uixpress")}},c=u("roles"),P=async s=>{k.value.show(s,M()),await v(),U(),Array.isArray(l.value)||(l.value=[])},v=async()=>{const s={endpoint:"wp/v2/users",params:{...r.value,search:_.value}},e=await A(s);e&&(w.value=e.data,r.value.pages=e.totalPages,r.value.total=e.totalItems)},U=async()=>{const e=await A({endpoint:"uixpress/v1/user-roles",params:{}});e&&(y.value=e.data)},M=s=>{const t=h.value.getBoundingClientRect();return{clientY:t.bottom+10,clientX:t.left}},b=s=>Array.isArray(l.value)?l.value.find(e=>e.id==s.id):(l.value=[],!1),R=s=>{if(b(s)){const e=l.value.findIndex(t=>t.id==s.id);l.value.splice(e,1)}else l.value.push({id:s.id,value:s.slug,type:"user"})},C=s=>Array.isArray(l.value)?l.value.find(e=>e.value==s.value):(l.value=[],!1),S=s=>{if(C(s)){const e=l.value.findIndex(t=>t.value==s.value);l.value.splice(e,1)}else l.value.push({id:"",value:s.value,type:"role"})},D=()=>{r.value.page--,v()},E=()=>{r.value.page++,v()};return T(()=>{Array.isArray(l.value)||(l.value=[])}),(s,e)=>(a(),o(m,null,[l.value?(a(),o("div",Y({key:0,onClick:P},j(I),{ref_key:"parent",ref:h,class:"px-2 py-2 border border-zinc-200 dark:border-zinc-700 rounded-lg w-full transition-all outline outline-transparent outline-offset-[-2px] focus:outline-indigo-300 dark:focus:outline-indigo-700 focus:shadow-xs text-sm col-span-2 flex flex-row gap-3 items-center"}),[l.value.length?(a(),o("span",W,f(`${l.value.length} ${s.__("Items selected","uixpress")}`),1)):(a(),o("span",Z,f(s.__("Select users or roles","uixpress")),1)),l.value.length?(a(),H(x,{key:2,type:"transparent",onClick:e[0]||(e[0]=J(t=>l.value=[],["stop","prevent"]))},{default:g(()=>[n(p,{icon:"close"})]),_:1})):d("",!0),n(p,{icon:"unfold"})],16)):d("",!0),n(G,{ref_key:"contextmenu",ref:k},{default:g(()=>[i("div",ee,[n(Q,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),options:B},null,8,["modelValue"]),i("div",se,[L(i("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>_.value=t),class:"px-2 py-2 pl-8 border border-zinc-200 dark:border-zinc-700 rounded-lg w-full transition-all outline outline-transparent outline-offset-[-2px] focus:outline-indigo-300 dark:focus:outline-indigo-700 focus:shadow-xs text-sm dark:bg-transparent",placeholder:s.__("Search"),onKeyup:X(v,["enter"])},null,40,le),[[q,_.value]]),i("div",te,[n(p,{icon:"search",class:"text-lg text-zinc-400"})])]),c.value==="users"?(a(),o("div",ae,[(a(!0),o(m,null,z(w.value,t=>(a(),o("div",{class:"flex flex-row items-center gap-3 p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors rounded-lg cursor-pointer",onClick:F=>R(t)},[n(V,{checked:!!b(t)},null,8,["checked"]),i("div",null,f(t.slug),1)],8,oe))),256))])):d("",!0),c.value==="roles"?(a(),o("div",ne,[(a(!0),o(m,null,z(y.value,t=>(a(),o("div",{class:"flex flex-row items-center gap-3 p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors rounded-lg cursor-pointer",onClick:F=>S(t)},[n(V,{checked:!!C(t)},null,8,["checked"]),i("div",null,f(t.value),1)],8,re))),256))])):d("",!0),c.value=="users"?(a(),o("div",ue,[n(x,{type:"default",disabled:r.value.page==1,onClick:D},{default:g(()=>[n(p,{icon:"chevron_left"})]),_:1},8,["disabled"]),n(x,{type:"default",disabled:r.value.page>=r.value.pages,onClick:E},{default:g(()=>[n(p,{icon:"chevron_right"})]),_:1},8,["disabled"])])):d("",!0)])]),_:1},512)],64))}};export{ve as _};
//# sourceMappingURL=index-DQSO8XBg.js.map
