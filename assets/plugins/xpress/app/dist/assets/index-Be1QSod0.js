import{r as v,c as L,a as B,o as O,y as W,b as u,d,j as k,f as z,I as _,k as f,F as R,m as A,t as m,C as E,_ as M,J as G,n as I,g as Q,W as X,p as C}from"./_plugin-vue_export-helper-y4Xv5kKr.js";const Y=["onClick","title"],Z=["placeholder","disabled"],ee=["onClick"],te={key:0,class:"text-[10px] text-zinc-500 dark:text-zinc-400"},ae={key:1,class:"px-3 py-2 text-xs text-zinc-500 dark:text-zinc-400 text-center"},ne={__name:"index",props:{modelValue:{type:Array,default:()=>[]},availableTags:{type:Array,default:()=>[]},placeholder:{type:String,default:"Add tags..."},disabled:{type:Boolean,default:!1},allowCreate:{type:Boolean,default:!0}},emits:["update:modelValue","add","remove","create"],setup(c,{emit:F}){const l=c,p=F,x=v(null),b=v(null),g=v(null),n=v(""),i=v(!1),o=v(-1),h=v(!1),s=L(()=>{if(!n.value.trim())return l.availableTags.filter(a=>!l.modelValue.some(t=>t.id===a.id));const e=n.value.toLowerCase();return l.availableTags.filter(a=>a.name.toLowerCase().includes(e)&&!l.modelValue.some(t=>t.id===a.id))}),S=L(()=>!l.disabled),N=()=>{l.disabled||(i.value=s.value.length>0||n.value.trim())},U=e=>{var t,r;const a=e.relatedTarget;a&&((t=g.value)!=null&&t.contains(a)||(r=b.value)!=null&&r.contains(a))||(i.value=!1,o.value=-1)},$=e=>{var a;if(!l.disabled){if(e.key==="Backspace"&&!n.value&&l.modelValue.length>0){e.preventDefault(),V(l.modelValue[l.modelValue.length-1].id);return}if(e.key==="Escape"){i.value=!1,o.value=-1,(a=x.value)==null||a.blur();return}if(e.key==="ArrowDown"){e.preventDefault(),i.value&&s.value.length>0?(o.value=Math.min(o.value+1,s.value.length-1),T()):i.value||(i.value=!0,o.value=0);return}if(e.key==="ArrowUp"){e.preventDefault(),i.value&&(o.value=Math.max(o.value-1,-1),T());return}if(e.key==="Enter"&&!h.value){e.preventDefault(),o.value>=0&&s.value[o.value]?w(s.value[o.value]):n.value.trim()&&l.allowCreate&&y(n.value.trim());return}if(e.key===","&&!h.value){e.preventDefault(),n.value.trim()&&l.allowCreate&&y(n.value.trim());return}}},j=()=>{h.value=!0},q=()=>{h.value=!1},K=()=>{n.value.trim()?(i.value=!0,o.value=-1):i.value=s.value.length>0},w=e=>{if(l.modelValue.some(t=>t.id===e.id))return;const a=[...l.modelValue,e];p("update:modelValue",a),p("add",e),n.value="",i.value=!1,o.value=-1,C(()=>{var t;(t=x.value)==null||t.focus()})},V=e=>{const a=l.modelValue.filter(r=>r.id!==e);p("update:modelValue",a);const t=l.modelValue.find(r=>r.id===e);t&&p("remove",t),C(()=>{var r;(r=x.value)==null||r.focus()})},y=e=>{if(!e.trim()||!l.allowCreate)return;const a=l.availableTags.find(t=>t.name.toLowerCase()===e.toLowerCase());a?w(a):(p("create",e.trim()),n.value="",i.value=!1,o.value=-1)},P=(e,a)=>{a.preventDefault(),a.stopPropagation(),w(e)},H=e=>{e.preventDefault(),e.stopPropagation(),y(n.value.trim())},T=()=>{C(()=>{const e=g.value,a=e==null?void 0:e.querySelectorAll("button"),t=a==null?void 0:a[o.value];t&&e&&t.scrollIntoView({block:"nearest",behavior:"smooth"})})};B(()=>l.availableTags,()=>{n.value.trim()&&s.value.length>0&&(i.value=!0)}),B(()=>l.modelValue,()=>{n.value.trim()&&(i.value=s.value.length>0)});const D=e=>{b.value&&!b.value.contains(e.target)&&g.value&&!g.value.contains(e.target)&&(i.value=!1,o.value=-1)};return O(()=>{document.addEventListener("mousedown",D)}),W(()=>{document.removeEventListener("mousedown",D)}),(e,a)=>(d(),u("div",{ref_key:"containerRef",ref:b,class:"relative w-full"},[k("div",{class:I(["flex flex-wrap items-center gap-1.5 min-h-[42px] px-2 py-1.5 bg-transparent border border-zinc-200 dark:border-zinc-700/40 rounded-lg w-full transition-all outline outline-transparent outline-offset-[-2px] focus-within:outline-indigo-300 dark:focus-within:outline-indigo-700 focus-within:shadow-xs text-sm",{"opacity-50 cursor-not-allowed":c.disabled,"bg-zinc-50 dark:bg-zinc-900/50":!c.disabled}]),onClick:a[1]||(a[1]=t=>{var r;return(r=x.value)==null?void 0:r.focus()})},[(d(!0),u(R,null,A(c.modelValue,t=>(d(),u("div",{key:t.id,class:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-zinc-100 dark:bg-zinc-800 rounded-md text-xs text-zinc-700 dark:text-zinc-300 group"},[k("span",null,m(t.name),1),c.disabled?f("",!0):(d(),u("button",{key:0,onClick:E(r=>V(t.id),["stop"]),class:"text-zinc-500 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors ml-0.5",title:e.__("Remove tag","uixpress"),type:"button"},[z(M,{icon:"close",class:"text-xs"})],8,Y))]))),128)),S.value?_((d(),u("input",{key:0,ref_key:"inputRef",ref:x,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value=t),type:"text",placeholder:c.modelValue.length===0?c.placeholder:"",disabled:c.disabled,onFocus:N,onBlur:U,onKeydown:$,onInput:K,onCompositionstart:j,onCompositionend:q,class:"flex-1 min-w-[120px] bg-transparent border-0 outline-0 text-sm text-zinc-900 dark:text-zinc-100 placeholder-zinc-400 dark:placeholder-zinc-500"},null,40,Z)),[[G,n.value]]):f("",!0)],2),z(X,{"enter-active-class":"transition-all duration-150 ease-out","enter-from-class":"opacity-0 scale-95 translate-y-[-4px]","enter-to-class":"opacity-100 scale-100 translate-y-0","leave-active-class":"transition-all duration-100 ease-in","leave-from-class":"opacity-100 scale-100 translate-y-0","leave-to-class":"opacity-0 scale-95 translate-y-[-4px]"},{default:Q(()=>[i.value&&!c.disabled?(d(),u("div",{key:0,ref_key:"dropdownRef",ref:g,class:"absolute z-50 w-full mt-1 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg shadow-lg max-h-64 overflow-auto tag-dropdown",onMousedown:a[3]||(a[3]=E(()=>{},["prevent"]))},[(d(!0),u(R,null,A(s.value,(t,r)=>(d(),u("button",{key:t.id,onClick:J=>P(t,J),type:"button",tabindex:"-1",class:I(["w-full px-3 py-2 text-left text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700 transition-colors flex items-center justify-between",o.value===r?"bg-zinc-100 dark:bg-zinc-700":""])},[k("span",null,m(t.name),1),t.count!==void 0?(d(),u("span",te," ("+m(t.count)+") ",1)):f("",!0)],10,ee))),128)),n.value.trim()&&c.allowCreate&&!s.value.some(t=>t.name.toLowerCase()===n.value.trim().toLowerCase())?(d(),u("button",{key:0,onClick:a[2]||(a[2]=t=>H(t)),type:"button",tabindex:"-1",class:"w-full px-3 py-2 text-left text-sm text-indigo-600 dark:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 transition-colors flex items-center gap-2 border-t border-zinc-200 dark:border-zinc-700"},[z(M,{icon:"add",class:"text-sm"}),k("span",null,m(e.__("Create tag","uixpress"))+': "'+m(n.value.trim())+'"',1)])):f("",!0),s.value.length===0&&!n.value.trim()?(d(),u("div",ae,m(e.__("No tags available","uixpress")),1)):f("",!0)],544)):f("",!0)]),_:1})],512))}};export{ne as _};
//# sourceMappingURL=index-Be1QSod0.js.map
